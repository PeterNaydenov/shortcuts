!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).shortcuts={})}(this,function(t){"use strict";var e={_normalizeWithPlugins:function(t,e){return function(t){const n=e.shortcuts;Object.keys(n).forEach(e=>{Object.entries(n[e]).forEach(([i,o])=>{const r=t(i);r!==i&&(delete n[e][i],n[e][r]=o)})})}},_readShortcutWithPlugins:function(t,e){return function(n){const{inAPI:i}=t,o=n.split(":")[0].toLowerCase().trim(),r=i._systemAction(o,"none");let s=n;return-1!==r&&(s=e.plugins[r].shortcutName(n)),s}},_setupPlugin:function(t,e){const{inAPI:n}=t,{currentContext:i,shortcuts:o,exposeShortcut:r,ERROR_EVENT_NAME:s}=e;return function(e){const{prefix:c,_normalizeShortcutName:u,_registerShortcutEvents:l,_listenDOM:a,pluginState:f,deps:d}=e,{resetState:p}=d;f.currentContext=i,f.shortcuts=o,f.exposeShortcut=r,f.ERROR_EVENT_NAME=s;const h={ev:t.ev,extra:t.extra,...d};n._normalizeWithPlugins(u);let m=l(h,f);const g=a(h,f);m>0&&g.start();const v={getPrefix:()=>c,shortcutName:t=>u(t),contextChange:()=>{p(),m=l(h,f),m<1&&g.stop(),m>0&&g.start()},mute:()=>g.stop(),unmute:()=>g.start(),destroy:()=>{g.stop(),p()}};return Object.freeze(v),v}},_systemAction:function(t,e){return function(t,n,i=null){return e.plugins.findIndex(e=>e.getPrefix()===t&&(e[n]&&e[n](i),!0))}},changeContext:function(t,e){const{shortcuts:n,currentContext:i,ERROR_EVENT_NAME:o}=e,{ev:r}=t;return function(t=!1){const s=i.name;if(!t)return r.reset(),void(i.name=null);s!==t&&(n[t]?(n[s]&&r.reset(),i.name=t,e.plugins.forEach(e=>e.contextChange(t)),Object.entries(n[t]).forEach(([t,e])=>{t.includes(":SETUP")||e.forEach(e=>r.on(t,e))}),r.on("*",(...t)=>{e.exposeShortcut&&e.exposeShortcut(...t)})):r.emit(o,`Context '${t}' does not exist`))}},listShortcuts:function(t,e){const n=e.shortcuts;return function(t=null){if(null!=t){const e=n[t];return null==e?null:Object.entries(e).map(([t,e])=>t)}return Object.keys(n).map(t=>{const e={};return e.context=t,e.shortcuts=Object.entries(n[t]).map(([t,e])=>t),e})}},load:function(t,e){const{shortcuts:n,plugins:i}=e,{API:{changeContext:o,getContext:r}}=t;return function(t){const e=r(),s=i.map(t=>t.getPrefix().toUpperCase());let c=!1;Object.entries(t).forEach(([t,o])=>{t===e&&(c=!0),n[t]={},Object.entries(o).forEach(([e,o])=>{let r=e;const c=e.toUpperCase().trim(),u=s.map((t,e)=>c.startsWith(t)?e:null).filter(t=>null!==t);if(u.length){const t=u[0];r=i[t].shortcutName(e)}o instanceof Function&&(o=[o]),n[t][r]=o})}),c&&(o(),o(e))}},unload:function(t,e){const{currentContext:n,shortcuts:i,ERROR_EVENT_NAME:o}=e,{ev:r}=t;return function(t){n.name!==t?i[t]?delete i[t]:r.emit(o,`Context '${t}' does not exist`):r.emit(o,`Context '${t}' can't be removed during is current active context. Change the context first`)}}};function n(t,e){const{ev:n,_specialChars:i,_readKeyEvent:o,extra:r,resetState:s}=t,{currentContext:c,streamKeys:u,listenOptions:l}=e;let a=[],f=null,d=!0,p=!1;const h=()=>d=!1,m=()=>d=!0,g=()=>p=!0,v=()=>!1===d;function x(){const t=a.map(t=>[t.join("+")]),i={wait:h,end:m,ignore:g,isWaiting:v,note:c.note,context:c.name,dependencies:r,options:e.listenOptions,viewport:{X:window.scrollX,Y:window.scrollY,width:window.innerWidth,height:window.innerHeight},type:"key"};if(!d){const e=`KEY:${t.at(-1).join("+")}`;n.emit(e,i),p&&(a=a.slice(0,-1),p=!1)}if(d){const o=`KEY:${t.join(",")}`;n.emit(o,i),p&&(a=a.slice(0,-1),p=!1),a=[],clearTimeout(e.keyIgnore),e.keyIgnore=null,clearTimeout(f),f=null}}function E(n){clearTimeout(f);if(i().hasOwnProperty(n.code))return a.push(o(n,i)),u&&u({key:n.key,context:c.name,note:c.note,dependencies:t.extra}),e.keyIgnore?(clearTimeout(e.keyIgnore),e.keyIgnore=setTimeout(()=>e.keyIgnore=null,l.keyWait),void a.pop()):d&&a.length===e.maxSequence?(x(),void(e.keyIgnore=setTimeout(()=>e.keyIgnore=null,l.keyWait))):void(d?f=setTimeout(x,l.keyWait):x())}function O(n){if(!i().hasOwnProperty(n.code)){if(clearTimeout(f),u&&u({key:n.key,context:c.name,note:c.note,dependencies:t.extra}),e.keyIgnore)return clearTimeout(e.keyIgnore),void(e.keyIgnore=setTimeout(()=>e.keyIgnore=null,l.keyWait));if(a.push(o(n,i)),d&&a.length===e.maxSequence)return x(),void(e.keyIgnore=setTimeout(()=>e.keyIgnore=null,l.keyWait));d?f=setTimeout(x,l.keyWait):x()}}return{start:function(){e.active||(document.addEventListener("keydown",E),document.addEventListener("keypress",O),e.active=!0)},stop:function(){e.active&&(document.removeEventListener("keydown",E),document.removeEventListener("keypress",O),e.active=!1,f&&(clearTimeout(f),f=null),e.keyIgnore&&(clearTimeout(e.keyIgnore),e.keyIgnore=null),a=[],d=!0,p=!1)}}}function i(t){const e=t.toUpperCase(),n=/KEY\s*\:/i.test(e),i=e.indexOf(":");if(!n)return t;if(e.includes("SETUP"))return"KEY:SETUP";return`KEY:${e.slice(i+1).split(",").map(t=>t.trim()).map(t=>t.split("+").map(t=>t.trim()).sort().join("+")).join(",")}`}function o(t,e){const{shiftKey:n,altKey:i,ctrlKey:o}=t,r=e(),s=t.code.replace("Key","").replace("Digit",""),c=[];return o&&c.push("CTRL"),n&&c.push("SHIFT"),i&&c.push("ALT"),r.hasOwnProperty(s)?c.push(r[s].toUpperCase()):["ControlLeft","ControlRight","ShiftLeft","ShiftRight","AltLeft","AltRight","Meta"].includes(s)||c.push(s.toUpperCase()),c.sort()}function r(t,e){let n=0,i=!1;const o=e.defaultOptions,{regex:r}=t,{currentContext:{name:s},shortcuts:c}=e;return null==s?0:(Object.entries(c[s]).forEach(([s,c])=>{if(!r.test(s))return;if("KEY:SETUP"===s){i=!0;const n=c.reduce((n,i)=>{const o=i({dependencies:t.extra,defaults:structuredClone(e.defaultOptions),options:e.listenOptions});return Object.assign(n,o)},o);return void Object.assign(e.listenOptions,n)}n++;const u=s.slice(4).split(",").length;e.maxSequence<u&&(e.maxSequence=u)}),i||Object.assign(e.listenOptions,o),n)}function s(){return{ArrowLeft:"LEFT",ArrowUp:"UP",ArrowRight:"RIGHT",ArrowDown:"DOWN",Enter:"ENTER",NumpadEnter:"ENTER",Escape:"ESC",Backspace:"BACKSPACE",Space:"SPACE",Tab:"TAB",Backquote:"`",BracketLeft:"[",BracketRight:"]",Equal:"=",Slash:"/",Backslash:"\\",IntlBackslash:"`",F1:"F1",F2:"F2",F3:"F3",F4:"F4",F5:"F5",F6:"F6",F7:"F7",F8:"F8",F9:"F9",F10:"F10",F11:"F11",F12:"F12"}}function c(t,e,n){const{listenOptions:{clickTarget:i}}=e,o=n;if(o===document.body)return null;return i.some(t=>o.hasAttribute(t))?o:c(t,e,o.parentNode)}function u(t,e){const{ev:n,_findTarget:i,_readClickEvent:o,extra:r}=t,{listenOptions:s,currentContext:c}=e;let u=null,l=null,a=null,f=null,d=0;function p(){if(!u)return;const{left:t,top:i,width:s,height:p}=u.getBoundingClientRect(),h=window.scrollX,m=window.scrollY,g=o(l,d),v={target:u,x:l.clientX,y:l.clientY,context:c.name,note:c.note,options:e.listenOptions,event:l,dependencies:r,viewport:{X:h,Y:m,width:window.innerWidth,height:window.innerHeight},sizes:{width:s,height:p},position:{x:t,y:i},pagePosition:{x:t+h,y:i+m},type:"click"};n.emit(g,v),a=null,f=null,u=null,l=null,d=0}function h(n){let o=e.maxLeftClicks;if(clearTimeout(a),f)return clearTimeout(f),void(f=setTimeout(()=>f=null,s.mouseWait));if(u=i(t,e,n.target),null!=u){if(u&&u.dataset.hasOwnProperty("quickClick")&&(o=1),u&&"A"===u.tagName&&(o=1),l=n,d++,d>=o)return p(),void(o>1&&(f=setTimeout(()=>f=null,s.mouseWait)));a=setTimeout(p,s.mouseWait)}}function m(n){let o=e.maxRightClicks;if(clearTimeout(a),f)return clearTimeout(f),void(f=setTimeout(()=>f=null,s.mouseWait));if(u=i(t,e,n.target),null!=u){if(u&&u.dataset.hasOwnProperty("quickClick")&&(o=1),u&&"A"===u.tagName&&(o=1),l=n,d++,d>=o)return p(),void(o>1&&(f=setTimeout(()=>f=null,s.mouseWait)));a=setTimeout(p,s.mouseWait)}}return{start:function(){e.active||(window.addEventListener("contextmenu",m),document.addEventListener("click",h),e.active=!0)},stop:function(){e.active&&(window.removeEventListener("contextmenu",m),document.removeEventListener("click",h),e.active=!1,f&&(clearTimeout(f),f=null),u=null,l=null,d=0)}}}function l(t){const e=t.toUpperCase(),n=/CLICK\s*\:/i.test(e),i=["LEFT","MIDDLE","RIGHT"],o=["ALT","SHIFT","CTRL"];let r=null,s=0;const c=[],u=e.indexOf(":");if(!n)return t;if(e.includes("SETUP"))return"CLICK:SETUP";return e.slice(u+1).trim().split("-").map(t=>t.trim()).forEach(t=>{i.includes(t)?r=t:o.includes(t)?c.push(t):isNaN(t)||(s=t)}),`CLICK:${r}-${s}${c.length>0?"-":""}${c.sort().join("-")}`}function a(t,e){const{shiftKey:n,altKey:i,ctrlKey:o,key:r,button:s}=t,c=`CLICK:${["LEFT","MIDDLE","RIGHT"][s]}-${e}`,u=[];return o&&u.push("CTRL"),n&&u.push("SHIFT"),i&&u.push("ALT"),u.length>0?`${c}${u.length>0?"-":""}${u.sort().join("-")}`:`${c}`}function f(t,e){let n=0,i=!1;const o=e.defaultOptions,{regex:r}=t,{listenOptions:s,currentContext:{name:c},shortcuts:u}=e;return null==c||(Object.entries(u[c]).forEach(([c,u])=>{if(!r.test(c))return;if("CLICK:SETUP"===c){i=!0;const n=u.reduce((n,i)=>{const o=i({dependencies:t.extra,defaults:structuredClone(e.defaultOptions),options:s});return Object.assign(n,o)},o);return void Object.assign(e.listenOptions,n)}n++;const[l,a]=c.slice(6).split("-");"LEFT"===l&&e.maxLeftClicks<a&&(e.maxLeftClicks=a),"RIGHT"===l&&e.maxRightClicks<a&&(e.maxRightClicks=a)}),i||Object.assign(e.listenOptions,o)),n}function d(t,e){const{ev:n}=t;let i=null;function o(t,e,n,i){const{left:o,top:r,width:s,height:c}=n.target.getBoundingClientRect(),u=window.scrollX,l=window.scrollY;return{target:n.target,context:e.currentContext.name,note:e.currentContext.note,event:n,dependencies:t.extra,options:e.listenOptions,viewport:{X:u,Y:l,width:window.innerWidth,height:window.innerHeight},sizes:{width:s,height:c},position:{x:o,y:r},pagePosition:{x:o+u,y:r+l},type:i}}function r(i){const{callbacks:r,typeFn:s}=e;i.target;const c=o(t,e,i,"form-in"),u=`${s(c)}/in`;null!=r[u]&&n.emit(u,c,r[u])}function s(i){const{callbacks:r,typeFn:s}=e,c=o(t,e,i,"form-out"),u=`${s(c)}/out`;null!=r[u]&&n.emit(u,c,r[u])}function c(r){const{callbacks:s,typeFn:c}=e,u=o(t,e,r,"form-instant"),l=c(u),a=e.wait[`${l}`],f=`${l}/instant`;if(null==s[f])return;if(0===a)return void n.emit(f,u,s[f]);clearTimeout(i),i=setTimeout(()=>n.emit(f,u,s[f]),a)}return{start:function(){e.active||(document.addEventListener("focusin",r),document.addEventListener("focusout",s),document.addEventListener("input",c),e.active=!0)},stop:function(){e.active&&(document.removeEventListener("focusin",r),document.removeEventListener("focusout",s),document.removeEventListener("input",c),e.active=!1,i&&(clearTimeout(i),i=null))}}}function p(t){const e=t.toUpperCase(),n=/FORM\s*\:/i.test(e),i=e.indexOf(":");if(!n)return t;return`FORM:${e.slice(i+1).trim()}`}function h(t,e){const{regex:n,_defaults:i,ev:o}=t,{currentContext:{name:r,note:s},shortcuts:c,callbacks:u,ERROR_EVENT_NAME:l,defaultOptions:a}=e;let f=[],d=[],p=[],h=0;if(null==r)return!1;if(Object.entries(c[r]).forEach(([i,o])=>{if(n.test(i)){if(i.includes("SETUP")){const n=o.reduce((n,i)=>{const o=i({dependencies:t.extra,defaults:structuredClone(e.defaultOptions),options:e.listenOptions});return Object.assign(n,o)},a);return void Object.assign(e.listenOptions,n)}"FORM:WATCH"===i&&(f=o),"FORM:DEFINE"===i&&(d=o),"FORM:ACTION"===i&&(p=o)}}),0===p.length)return h;const m=new Set;0===d.length&&(d=[i.define]),0===f.length&&(f=[i.watch]);const g=f.map(n=>n({dependencies:t.extra,context:r,note:s,options:e.listenOptions})).reduce((t,e)=>(t.push(e),t),[]);return e.watchList=document.querySelectorAll(g),e.watchList.forEach(n=>{const{left:i,top:o,width:c,height:u}=n.getBoundingClientRect(),l=window.scrollX,a=window.scrollY;return m.add(d[0]({target:n,context:r,note:s,dependencies:t.extra,options:e.listenOptions,viewport:{X:l,Y:a,width:window.innerWidth,height:window.innerHeight},sizes:{width:c,height:u},position:{x:i,y:o},pagePosition:{x:i+l,y:o+a}}))}),e.typeFn=d[0]?d[0]:i.define,p.forEach(n=>{if(!(n instanceof Function))return o.emit(l,"The 'form:action' should be a function."),!1;const i=n({dependencies:t.extra,options:e.listenOptions});if(!(i instanceof Array))return o.emit(l,"Warning: The 'form:action' function should RETURN an array."),!1;i.forEach(({fn:t,type:n,timing:i,wait:r=0})=>{if(m.has(n)&&t instanceof Function){const e=`${n}/${i}`,r=u.hasOwnProperty(e);r?u[e].push(t):u[e]=[t],r||o.on(e,(t,e)=>{e.forEach(e=>{e instanceof Function&&e(t)})})}"instant"===i&&(e.wait[`${n}`]=r)})}),h=Object.keys(e.callbacks).length,h}const m={watch:()=>"input, select, textarea, button, a",define:({target:t})=>"checkbox"===t.type||"radio"===t.type?"checkbox":"button"==t.type||"submit"==t.type?"button":"input"};function g(t,e,n){const{listenOptions:{hoverTarget:i}}=e,o=n;if(o===document.body)return!1;if(o===document)return!1;return i.some(t=>o.hasAttribute(t))?o:g(t,e,o.parentNode)}function v(t,e){const{ev:n,_findTarget:i,resetState:o,extra:r}=t;function s(o){const s=o.clientX,c=o.clientY,{hovered:u,hoverRectangle:l,listenOptions:a,hoverTimer:f,leaveTimer:d,lastEvent:p,lastHoverTarget:h}=e,m=i(t,e,o.target);if(!function(t,e,n){return!!t&&e>=t.left&&e<=t.right&&n>=t.top&&n<=t.bottom}(l,s,c)&&m!==u){if(u&&!m){if(e.hovered=!1,e.hoverRectangle=null,f&&(clearTimeout(f),e.hoverTimer=null),"off"===p)return;return void(e.leaveTimer=setTimeout(()=>{n.emit("HOVER:OFF",g(u)),e.leaveTimer=null,e.lastEvent="off"},a.wait))}u&&(n.emit("HOVER:OFF",g(u)),e.leaveTimer=null,e.lastEvent="off"),clearTimeout(d),clearTimeout(f),e.hovered=m,e.hoverRectangle=m.getBoundingClientRect(),e.hoverTimer=setTimeout(()=>{n.emit("HOVER:ON",g(m)),e.hoverTimer=null,e.lastHoverTarget=m,e.lastEvent="on"},a.wait)}function g(t){const{left:n,top:i,width:s,height:c}=t.getBoundingClientRect(),u=window.scrollX,l=window.scrollY;return{target:t,context:e.currentContext.name,note:e.currentContext.note,event:o,dependencies:r,options:e.listenOptions,viewport:{X:u,Y:l,width:window.innerWidth,height:window.innerHeight},sizes:{width:s,height:c},position:{x:n,y:i},pagePosition:{x:n+u,y:i+l},type:"hover"}}}return{start:function(){e.active||(document.addEventListener("mousemove",s),e.active=!0)},stop:function(){e.active&&(document.removeEventListener("mousemove",s),o())}}}function x(t){const e=t.toUpperCase(),n=/HOVER\s*\:/i.test(e),i=e.indexOf(":");if(!n)return t;return`HOVER:${e.slice(i+1).trim()}`}function E(t,e){let n=0,i=!1;const o=e.defaultOptions,{regex:r,_defaults:s,ev:c}=t,{currentContext:{name:u},shortcuts:l,ERROR_EVENT_NAME:a}=e;return null==u||(Object.entries(l[u]).forEach(([s,c])=>{if(r.test(s)){if("HOVER:SETUP"===s){i=!0;const n=c.reduce((n,i)=>{const o=i({dependencies:t.extra,defaults:structuredClone(e.defaultOptions),options:e.listenOptions});return Object.assign(n,o)},o);return void Object.assign(e.listenOptions,n)}n++}}),i||Object.assign(e.listenOptions,o)),n}function O(t,e){const{ev:n,resetState:i,extra:o}=t;let r=null,s=null;function c(t){t.clientX,t.clientY;const{lastPosition:i,lastDirection:c,listenOptions:u,currentContext:l}=e,{scrollWait:a,endScrollWait:f,minSpace:d}=u;if(!i)return;let p=null;const h=window.scrollX,m=window.scrollY,g=Math.abs(m-i.y),v=Math.abs(h-i.x);if(g<d&&v<d)return;const x=[];g>=d&&(m>i.y?x.push("down"):x.push("up")),v>=d&&(h>i.x?x.push("right"):x.push("left")),p=x[0]||null;const E=t=>({x:h,y:m,direction:t,context:l.name,note:l.note,dependencies:o,options:e.listenOptions,viewport:{X:h,Y:m,width:window.innerWidth,height:window.innerHeight},type:"scroll"});x.forEach(t=>{const e=`SCROLL:${t.toUpperCase()}`;n.emit(e,E(t))}),clearTimeout(r),clearTimeout(s);const O=x[x.length-1]||null;r=setTimeout(()=>{},a),s=setTimeout(()=>n.emit("SCROLL:END",E(O)),f),e.lastPosition={x:h,y:m},e.lastDirection=p}return{start:function(){e.active||(e.lastPosition={x:window.scrollX,y:window.scrollY},window.addEventListener("scroll",c),e.active=!0)},stop:function(){e.active&&(window.removeEventListener("scroll",c),i())}}}function y(t){const e=t.toUpperCase(),n=/SCROLL\s*\:/i.test(e),i=e.indexOf(":");if(!n)return t;return`SCROLL:${e.slice(i+1).trim()}`}function w(t,e){let n=0,i=!1;const o=e.defaultOptions,{regex:r}=t,{currentContext:{name:s},shortcuts:c}=e;return null==s||(Object.entries(c[s]).forEach(([s,c])=>{if(r.test(s)){if("SCROLL:SETUP"===s){i=!0;const n=c.reduce((n,i)=>{const o=i({dependencies:t.extra,defaults:structuredClone(e.defaultOptions),options:e.listenOptions});return Object.assign(n,o)},o);return void Object.assign(e.listenOptions,n)}n++}}),i||Object.assign(e.listenOptions,o)),n}t.pluginClick=function(t,e={}){const n={_findTarget:c,_readClickEvent:a,regex:/CLICK\s*\:/i},i={active:!1,maxLeftClicks:1,maxRightClicks:1,defaultOptions:{mouseWait:320,clickTarget:["data-click","href"]},listenOptions:{mouseWait:320,clickTarget:["data-click","href"]},streamKeys:!(!e.streamKeys||"function"!=typeof e.streamKeys)&&e.streamKeys};return n.resetState=function(){},t({prefix:"click",_normalizeShortcutName:l,_registerShortcutEvents:f,_listenDOM:u,pluginState:i,deps:n})},t.pluginForm=function(t,e={}){const n={_defaults:m,regex:/FORM\s*\:/i},i={callbacks:{},typeFn:"",watchList:[],wait:{},defaultOptions:{},listenOptions:{}};return n.resetState=function(){i.callbacks={},i.typeFn="",i.watchList=[],i.wait={}},t({prefix:"form",_normalizeShortcutName:p,_registerShortcutEvents:h,_listenDOM:d,pluginState:i,deps:n})},t.pluginHover=function(t,e={}){const n={_findTarget:g,regex:/HOVER\s*\:/i},i={active:!1,hovered:!1,hoverRectangle:null,hoverTimer:null,leaveTimer:null,lastEvent:"",lastHoverTarget:null,defaultOptions:{hoverTarget:["data-hover"],wait:320},listenOptions:{hoverTarget:["data-hover"],wait:320}};return n.resetState=function(){i.active=!1,i.hovered=!1,i.hoverRectangle=null,clearTimeout(i.hoverTimer),clearTimeout(i.leaveTimer),i.hoverTimer=null,i.leaveTimer=null,i.lastHoverTarget=null},t({prefix:"hover",_normalizeShortcutName:x,_registerShortcutEvents:E,_listenDOM:v,pluginState:i,deps:n})},t.pluginKey=function(t,e={}){const c={_specialChars:s,_readKeyEvent:o,regex:/KEY\s*\:/i},u={active:!1,maxSequence:1,keyIgnore:null,defaultOptions:{keyWait:480},listenOptions:{keyWait:480},streamKeys:!(!e.streamKeys||"function"!=typeof e.streamKeys)&&e.streamKeys};return c.resetState=function(){u.active=!1,u.keyIgnore=null,u.maxSequence=1},t({prefix:"key",_normalizeShortcutName:i,_registerShortcutEvents:r,_listenDOM:n,pluginState:u,deps:c})},t.pluginScroll=function(t,e={}){const n={regex:/SCROLL\s*\:/i},i={active:!1,lastPosition:null,lastDirection:null,defaultOptions:{scrollWait:50,endScrollWait:400,minSpace:40},listenOptions:{scrollWait:50,endScrollWait:400,minSpace:40}};return n.resetState=function(){i.active=!1},t({prefix:"scroll",_normalizeShortcutName:y,_registerShortcutEvents:w,_listenDOM:O,pluginState:i,deps:n})},t.shortcuts=function(t={}){const n={},i={},o=function(){let t={"*":[]},e={},n=new Set,i=!1,o="";return{on:function(e,n){t[e]||(t[e]=[]),t[e].push(n)},once:function(t,n){"*"!==t&&(e[t]||(e[t]=[]),e[t].push(n))},off:function(n,i){if(i)return t[n]&&(t[n]=t[n].filter(t=>t!==i)),e[n]&&(e[n]=e[n].filter(t=>t!==i)),t[n]&&0===t[n].length&&delete t[n],void(e[n]&&0===e[n].length&&delete t[n]);e[n]&&delete e[n],t[n]&&delete t[n]},reset:function(){t={"*":[]},e={},n=new Set},emit:function(){const[r,...s]=arguments;function c(e){let i=!1;"*"!==e&&(n.has(e)||(t[e].every(t=>{const e=t(...s);return"string"!=typeof e||"STOP"!==e.toUpperCase()||(i=!0,!1)}),i||t["*"].forEach(t=>t(r,...s))))}if(i&&(console.log(`${o} Event "${r}" was triggered.`),s.length>0&&(console.log("Arguments:"),console.log(...s),console.log("^----"))),"*"!==r){if(e[r]){if(n.has(r))return;e[r].forEach(t=>t(...s)),delete e[r]}t[r]&&c(r)}else Object.keys(t).forEach(t=>c(t))},stop:function(i){if("*"===i){const i=Object.keys(t),o=Object.keys(e);return void(n=new Set([...o,...i]))}n.add(i)},start:function(t){"*"!==t?n.delete(t):n.clear()},debug:function(t,e){i=!!t,e&&"string"==typeof e&&(o=e)}}}(),r={currentContext:{name:null,note:null},shortcuts:{},plugins:[],exposeShortcut:!(!t.onShortcut||"function"!=typeof t.onShortcut)&&t.onShortcut,ERROR_EVENT_NAME:t.errorEventName?t.errorEventName:"@shortcuts-error"},s={ev:o,inAPI:n,API:i,extra:{}};return i.enablePlugin=(t,e={})=>{if("function"!=typeof t)return;const i=t(n._setupPlugin,e),o=i.getPrefix(),s=n._systemAction(o,"none");-1===s?(r.plugins.push(i),i.unmute()):(i.destroy(),r.plugins[s].unmute())},i.disablePlugin=t=>{const e=n._systemAction(t,"destroy");-1!==e&&r.plugins.splice(e,1)},i.mutePlugin=t=>n._systemAction(t,"mute"),i.unmutePlugin=t=>n._systemAction(t,"unmute"),i.listPlugins=()=>r.plugins.map(t=>t.getPrefix()),i.getContext=()=>r.currentContext.name,i.getNote=()=>r.currentContext.note,i.setNote=(t=null)=>{"string"!=typeof t&&null!=t||(r.currentContext.note=t)},i.pause=(t="*")=>{const e=n._readShortcutWithPlugins(t);o.stop(e)},i.resume=(t="*")=>{const e=n._readShortcutWithPlugins(t);o.start(e)},i.emit=(t,...e)=>o.emit(n._readShortcutWithPlugins(t),...e),i.listContexts=()=>Object.keys(r.shortcuts),i.setDependencies=t=>Object.assign(s.extra,t),i.getDependencies=()=>s.extra,i.reset=function(){o.reset(),i.changeContext(),r.plugins.forEach(t=>t.destroy()),i.listContexts().map(t=>i.unload(t)),s.extra={},r.exposeShortcut=null},Object.entries(e).forEach(([t,e])=>{t.startsWith("_")?n[t]=e(s,r):i[t]=e(s,r)}),i}});
